<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hadoop完全分布式搭建</title>
      <link href="//2023/04/23/Hadoop%E6%90%AD%E5%BB%BA/"/>
      <url>//2023/04/23/Hadoop%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="Hadoop完全分布式—-环境搭建"><a href="#Hadoop完全分布式—-环境搭建" class="headerlink" title="Hadoop完全分布式—-环境搭建"></a>Hadoop完全分布式—-环境搭建</h1><p>Hadoop的环境搭建分为伪分布式和完全分布式，这里演示完全分布式搭建过程，并且以三台机器作为节点服务器。</p><h3 id="1、准备工作"><a href="#1、准备工作" class="headerlink" title="1、准备工作"></a>1、准备工作</h3><p>1.首先要准备好vmware虚拟机与centos7光盘映像，完成虚拟机的一个基础机的安装（可以选择最小系统进行安装）。</p><p>这里根据自己的电脑实际配置将内存尽可能的设置大一点，避免后面运行出错。其他步骤这里不作赘述。</p><p>2.将准备好的基础机打开，进行准备工作配置</p><ul><li><p>配置静态IP，避免因每次重新启动后，ip发生变化。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输入命令：vi /etc/sysconfig/network-scripts/ifcfg-ens33</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-2gt.pages.dev/img/9.png" alt="在这里插入图片描述"></p></li></ul><p>​    将上述红色框中的内容进行修改,并添加四行内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BOOTPROTO=&quot;static&quot;</span><br><span class="line">ONBOOT=&quot;yes&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IPADDR=192.168.10.102  （ip地址，根据自己的网卡进行设置）</span><br><span class="line">GATEWAY=192.168.10.2   （网关，网段.2）</span><br><span class="line">NETMASK=255.255.255.0  （子网掩码，可不写，默认24位掩码）</span><br><span class="line">DNS1=8.8.8.8           （公网dns解析地址1）</span><br><span class="line">DNS2=114.114.114.114   （公网dns解析地址2）</span><br></pre></td></tr></table></figure><p>​    修改完成后”：wq“进行保存退出并重启网卡。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure><ul><li><p>修改默认主机名称。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/hostname</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-2gt.pages.dev/img/10.png" alt="在这里插入图片描述"></p></li></ul><p>  第一台节点将原来的localhost改为master（第二、三台分别为slave1，slave2）</p><p>  修改完毕后保存退出。</p><ul><li><p>配置Linux下静态ip映射，添加自己的IP地址与对应的主机名称。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/hosts</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-2gt.pages.dev/img/11.png" alt="在这里插入图片描述"></p></li></ul><p>  添加完毕后保存退出即可。</p><ul><li><p>关闭防火墙。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld   (暂时关闭防火墙)</span><br><span class="line">systemctl disable firewalld  (永久关闭防火墙)</span><br></pre></td></tr></table></figure></li></ul><p>至此基本的准备工作配置已经完成。</p><h3 id="2、安装JDK"><a href="#2、安装JDK" class="headerlink" title="2、安装JDK"></a>2、安装JDK</h3><p>①进入opt目录下创建两个文件夹software（软件安装包）、module（解压后的文件）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir software module</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-2gt.pages.dev/img/12.png" alt="在这里插入图片描述"></p><p>②进入software目录下，使用xftp或者其他软件将jdk的安装包传进来并进行解压。<br><img src="https://pic-bed-2gt.pages.dev/img/13.png" alt="在这里插入图片描述"></p><p>使用命令进行解压</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-8u212-linux-x64.tar.gz -C /opt/module/</span><br></pre></td></tr></table></figure><p>这里指将jdk安装包解压到opt下的module目录， -C 参数代表解压到某文件目录，后面跟目录地址</p><p><img src="https://pic-bed-2gt.pages.dev/img/14.png" alt="在这里插入图片描述"></p><p>③解压完成后我们开始配置环境变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure><p>在etc下的profile.d目录下编辑一个新的文件用来存放以后各种软件的环境变量（在以前的版本中是直接在profile文件下进行添加）。</p><p>添加以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#JAVA_HOME</span><br><span class="line">export JAVA_HOME=/opt/module/jdk1.8.0_212</span><br><span class="line">#将JAVA_HOME拼接到PATH中</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-2gt.pages.dev/img/15.png" alt="在这里插入图片描述"></p><p>④添加完毕后保存退出</p><p>⑤source环境变量，使其生效</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure><p>⑥检验java是否安装成功，输入java和javac进行检验</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-2gt.pages.dev/img/16.png" alt="在这里插入图片描述"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-2gt.pages.dev/img/17.png" alt="在这里插入图片描述"></p><p>看到以上提示信息代表java已经安装完毕·。</p><h3 id="3、安装Hadoop"><a href="#3、安装Hadoop" class="headerlink" title="3、安装Hadoop"></a>3、安装Hadoop</h3><p>①进入software目录下，使用xftp或者其他软件将hadoop的安装包传进来并进行解压。</p><p>使用命令进行解压：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf hadoop-3.2.1.tar.gz -C /opt/module/</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-2gt.pages.dev/img/18.png" alt="在这里插入图片描述"></p><p>②解压完毕后，配置Hadoop的环境变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure><p>在my_env.sh中添加下面的内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#HADOOP_HOME</span><br><span class="line">export HADOOP_HOME=/opt/module/hadoop-3.2.1</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/bin</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/sbin</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-2gt.pages.dev/img/19.png" alt="在这里插入图片描述"></p><p>③使用source命令将环境变量生效</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure><p>④输入hadoop version检验当前hadoop是否安装完毕<br><img src="https://pic-bed-2gt.pages.dev/img/20.png" alt="在这里插入图片描述"></p><p>可以看到版本号即代表当前hadoop已经安装完毕。至此安装过程已经完成。</p><h3 id="4、克隆虚拟机"><a href="#4、克隆虚拟机" class="headerlink" title="4、克隆虚拟机"></a>4、克隆虚拟机</h3><p>在vmware左侧导航栏中右键当前虚拟机，管理，选择克隆，具体操作步骤见下图：<br><img src="https://pic-bed-2gt.pages.dev/img/26.png" alt="在这里插入图片描述"></p><p><img src="https://pic-bed-2gt.pages.dev/img/27.png" alt="在这里插入图片描述"></p><p><img src="https://pic-bed-2gt.pages.dev/img/28.png" alt="在这里插入图片描述"></p><p><img src="https://pic-bed-2gt.pages.dev/img/29.png" alt="在这里插入图片描述"></p><p><img src="https://pic-bed-2gt.pages.dev/img/30.png" alt="在这里插入图片描述"></p><p>之后单击完成即可。</p><p>注意，这里总共需要克隆两台机器，克隆时需要注意修改虚拟机名称分别为slave1、slave2，同时可以选择修改虚拟机保存的位置。</p><p>克隆完成后，按照上述过程中的步骤将克隆后的slave1和slave2进行主机名和ip地址的修改，修改完成后重新启动。</p><h3 id="5、编写xsync集群分发脚本"><a href="#5、编写xsync集群分发脚本" class="headerlink" title="5、编写xsync集群分发脚本"></a>5、编写xsync集群分发脚本</h3><p>①scp（secure copy）安全拷贝：</p><p>scp可以实现服务器与服务器之间的数据拷贝。（from server1 to server2），其基本语法为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp    -r        $pdir/$fname             $user@$host:$pdir/$fname</span><br><span class="line">命令   递归     要拷贝的文件路径/名称   目的地用户@主机:目的地路径/名称</span><br></pre></td></tr></table></figure><p>例如：在hadoop102上，将hadoop102中/opt/module/jdk1.8.0_212目录拷贝到hadoop103上。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r /opt/module/jdk1.8.0_212  xiaodong@hadoop103:/opt/module</span><br></pre></td></tr></table></figure><p>②rsync远程同步工具</p><p>rsync主要用于备份和镜像。具有速度快、避免复制相同内容和支持符号链接的优点。<br>rsync和scp区别：用rsync做文件的复制要比scp的速度快，rsync只对差异文件做更新。scp是把所有文件都复制过去。</p><p>其基本语法如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rsync    -av       $pdir/$fname             $user@$host:$pdir/$fname</span><br><span class="line">命令   选项参数   要拷贝的文件路径/名称   目的地用户@主机:目的地路径/名称</span><br></pre></td></tr></table></figure><p>-a    归档拷贝<br>-v    显示复制过程</p><p>例如：同步hadoop102中的/opt/module/hadoop-3.2.1到hadoop103</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -av hadoop-3.2.1/ xiaodong@hadoop103:/opt/module/hadoop-3.2.1/</span><br></pre></td></tr></table></figure><p>③xsync集群分发脚本</p><p>需求：循环复制文件到所有节点的相同目录下</p><p>需求分析：</p><ul><li><p>rsync命令原始拷贝：</p><p>rsync  -av     /opt/module           atguigu@hadoop103:/opt/</p></li><li><p>②期望脚本：</p><p>xsync要同步的文件名称</p></li><li><p>③期望脚本在任何路径都能使用（脚本放在声明了全局环境变量的路径）</p><p>[xiaodong@hadoop102 ~]$ echo $PATH</p><p>/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/xiaodong/.local/bin:/home/xiaodong/bin:/opt/module/jdk1.8.0_212/bin</p></li></ul><p>脚本实现：</p><ul><li><p>在/home/xiaodong/bin目录下创建xsync文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[xiaodong@hadoop102 opt]$ cd /home/xiaodong</span><br><span class="line">[xiaodong@hadoop102 ~]$ mkdir bin</span><br><span class="line">[xiaodong@hadoop102 ~]$ cd bin</span><br><span class="line">[xiaodong@hadoop102 bin]$ vim xsync</span><br></pre></td></tr></table></figure><p>在该文件中编写如下shell代码:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1. 判断参数个数</span></span><br><span class="line">if [ $# -lt 1 ]</span><br><span class="line">then</span><br><span class="line">    echo &quot;Not Enough Arguement!&quot;</span><br><span class="line">    exit</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2. 遍历集群所有机器</span></span><br><span class="line">for host in hadoop102 hadoop103 hadoop104</span><br><span class="line">do</span><br><span class="line">    echo ====================  $host  ====================</span><br><span class="line">    #3. 遍历所有目录，挨个发送</span><br><span class="line"></span><br><span class="line">    for file in $@</span><br><span class="line">    do</span><br><span class="line">        #4. 判断文件是否存在</span><br><span class="line">        if [ -e $file ]</span><br><span class="line">            then</span><br><span class="line">                #5. 获取父目录</span><br><span class="line">                pdir=$(cd -P $(dirname $file); pwd)</span><br><span class="line"></span><br><span class="line">                #6. 获取当前文件的名称</span><br><span class="line">                fname=$(basename $file)</span><br><span class="line">                ssh $host &quot;mkdir -p $pdir&quot;</span><br><span class="line">                rsync -av $pdir/$fname $host:$pdir</span><br><span class="line">            else</span><br><span class="line">                echo $file does not exists!</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>修改脚本 xsync 具有执行权限:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x xsync</span><br></pre></td></tr></table></figure></li><li><p>将脚本复制到/bin中，以便全局调用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp xsync /bin/</span><br></pre></td></tr></table></figure></li><li><p>同步环境变量配置（root所有者）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo xsync /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure></li><li><p>让环境变量生效</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xiaodong@hadoop103 bin]$ source /etc/profile</span><br><span class="line">[xiaodong@hadoop104 opt]$ source /etc/profile</span><br></pre></td></tr></table></figure></li></ul><h3 id="6、ssh无密码登录"><a href="#6、ssh无密码登录" class="headerlink" title="6、ssh无密码登录"></a>6、ssh无密码登录</h3><p>在home目录下输入命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p>然后敲（三个回车），就会生成两个文件id_rsa（私钥）、id_rsa.pub（公钥）</p><p>将公钥拷贝到要免密登录的目标机器上</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xiaodong@hadoop102 .ssh]$ ssh-copy-id hadoop102</span><br><span class="line">[xiaodong@hadoop102 .ssh]$ ssh-copy-id hadoop103</span><br><span class="line">[xiaodong@hadoop102 .ssh]$ ssh-copy-id hadoop104</span><br></pre></td></tr></table></figure><p>注意：在三台机器节点上都需要进行上述ssh无密登录配置，以便后续群起集群</p><h3 id="7、配置hadoop的四个xml文件"><a href="#7、配置hadoop的四个xml文件" class="headerlink" title="7、配置hadoop的四个xml文件"></a>7、配置hadoop的四个xml文件</h3><p>进入到配置文件的目录里：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/module/hadoop-3.2.1/etc/hadoop/</span><br></pre></td></tr></table></figure><p><img src="https://pic-bed-2gt.pages.dev/img/32.png" alt="在这里插入图片描述"></p><ul><li><p>core-site.xml</p><p>使用vi命令进行编辑，在<configuration></configuration>标签里添加如下内容</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定NameNode的地址 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:8020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 指定hadoop数据的存储目录 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 配置HDFS网页登录使用的静态用户为xiaodong --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.http.staticuser.user<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>xiaodong<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>hdfs-site.xml</p><p>使用vi命令进行编辑，在<configuration></configuration>标签里添加如下内容</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- nn web端访问地址--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:9870<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 2nn web端访问地址--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:9868<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>yarn-site.xml</p><p>使用vi命令进行编辑，在<configuration></configuration>标签里添加如下内容</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定MR走shuffle --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 指定ResourceManager的地址--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 环境变量的继承 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>mapred-site.xml</p></li></ul><p>​        使用vi命令进行编辑，在<configuration></configuration>标签里添加如下内容</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定MapReduce程序运行在Yarn上 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><p>全部配置完毕后，在当前目录下执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xsync ./</span><br></pre></td></tr></table></figure><p>将写好的配置文件分发到另外两台节点上。</p><h3 id="8、群起集群"><a href="#8、群起集群" class="headerlink" title="8、群起集群"></a>8、群起集群</h3><p>配置workers文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /opt/module/hadoop-3.2.1/etc/hadoop/workers</span><br></pre></td></tr></table></figure><p>将原来的localhost改为自己的三台主机名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><p>修改完毕后保存退出，xsync分发当前文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xsync workers</span><br></pre></td></tr></table></figure><p>启动集群：</p><p><strong>如果集群是第一次启动</strong>，需要在hadoop102节点（主节点）格式化NameNode</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure><p>启动HDFS：在主节点上执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-all.sh</span><br></pre></td></tr></table></figure><p><strong>在配置了ResourceManager的节点（hadoop103）</strong>启动YARN</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-yarn.sh</span><br></pre></td></tr></table></figure><p>启动完成后，观察各节点的jps进程：</p><p>hadoop102（master）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">13691 NameNode</span><br><span class="line">14651 Jps</span><br><span class="line">13836 DataNode</span><br><span class="line">14428 NodeManager</span><br></pre></td></tr></table></figure><p>hadoop102（slave1）:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2736 Jps</span><br><span class="line">1865 NodeManager</span><br><span class="line">2204 ResourceManager</span><br><span class="line">1742 DataNode</span><br></pre></td></tr></table></figure><p>hadoop103（slave2）:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1748 DataNode</span><br><span class="line">2182 Jps</span><br><span class="line">1963 NodeManager</span><br><span class="line">1871 SecondaryNameNode</span><br></pre></td></tr></table></figure><p>Web端查看HDFS的NameNode</p><p>①浏览器中输入：<a href="http://hadoop102:9870">http://hadoop102:9870</a></p><p>②查看HDFS上存储的数据信息</p><p><img src="https://pic-bed-2gt.pages.dev/img/36.png" alt="在这里插入图片描述"></p><p>Web端查看YARN的ResourceManager</p><p>①浏览器中输入：<a href="http://hadoop103:8088">http://hadoop103:8088</a></p><p>②查看YARN上运行的Job信息<br><img src="https://pic-bed-2gt.pages.dev/img/37.png" alt="在这里插入图片描述"></p><p>至此Hadoop的完全分布式集群就已经搭建完毕了！</p><p>注意：</p><ul><li><p>此文中的集群规划如下：</p><p>|      | hadoop102          | hadoop103                    | hadoop104                   |<br>| —— | ————————— | —————————————— | —————————————- |<br>| HDFS | NameNode  DataNode | DataNode                     | SecondaryNameNode  DataNode |<br>| YARN | NodeManager        | ResourceManager  NodeManager | NodeManager                 |</p></li><li><p>全文出现的hadoop102、hadoop103、hadoop104都要分别替换为自己的主机名称。</p></li></ul><p>大数据学习萌新，如遇到问题，欢迎指正！</p><p>求三连！</p>]]></content>
      
      
      <categories>
          
          <category> Hadoop </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 标签1 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
